import React, { createContext, useContext, useState, useEffect } from "react";

type TranslationContextType = {
  t: (key: string) => string;
  changeLanguage: (lang: string) => void;
  currentLanguage: string;
};

interface TranslationMap {
  [key: string]: {
    [key: string]: string;
  };
}

const TranslationContext = createContext<TranslationContextType>({
  t: () => "",
  changeLanguage: () => {},
  currentLanguage: "en",
});

// All of our translations
const translations: TranslationMap = {
  en: {
    home: "Home",
    record: "Record",
    archive: "Archive",
    translate: "Translate",
    settings: "Settings",
    about: "About",
    login: "Login",
    register: "Register",
    logout: "Logout",
    email: "Email",
    password: "Password",
    error: "Error",
    passwordsDoNotMatch: "Passwords do not match",
    welcomeBack: "Welcome Back!",
    loginToContinue: "Login to continue",
    loggingIn: "Logging In...",
    createAccount: "Create Account",
    joinAWAaz: "Join AWAaz",
    whatToCallYou: "What should we call you?",
    yourName: "Your Name",
    confirmPassword: "Confirm Password",
    creating: "Creating...",
    createAccountButton: "Create Account",
    upload: "Upload",
    languageMap: "Language Map",
    general: "General",
    account: "Account",
    preferences: "Preferences",
    displayName: "Display Name",
    updateProfile: "Update Profile",
    currentPassword: "Current Password",
    newPassword: "New Password",
    updatePassword: "Update Password",
    deleteAccount: "Delete Account",
    deleteAccountConfirmation: "Are you sure you want to delete your account? This action cannot be undone.",
    iUnderstand: "I understand the consequences",
    deleteMyAccount: "Delete My Account",
    language: "Language",
    english: "English",
    hindi: "Hindi",
    save: "Save",
    saved: "Saved",
    automaticTranslation: "Automatic Translation",
    automaticTranslationDescription: "Automatically translate recordings to your preferred language.",
    locationTracking: "Location Tracking",
    locationTrackingDescription: "Enable location tracking to improve language map accuracy.",
    recordAudio: "Record Audio",
    stopRecording: "Stop Recording",
    uploadRecording: "Upload Recording",
    translation: "Translation",
    originalText: "Original Text",
    translatedText: "Translated Text",
    recordNew: "Record New",
    signInWithGoogle: "Sign in with Google",
    signOut: "Sign Out",
    audioArchive: "Audio Archive",
    noRecordings: "No recordings yet. Start recording to see them here.",
    searchRecordings: "Search Recordings",
    search: "Search",
    clearSearch: "Clear Search",
    aboutAWAaz: "About AWAaz",
    awaazDescription: "AWAaz is a platform dedicated to preserving and promoting linguistic diversity. Record, translate, and share audio recordings to help document languages from around the world.",
    ourMission: "Our Mission",
    ourMissionDescription: "To empower communities to preserve their languages and cultures through accessible technology.",
    contactUs: "Contact Us",
    contactUsDescription: "Have questions or feedback? Reach out to us!",
    termsOfService: "Terms of Service",
    privacyPolicy: "Privacy Policy",
    awaazTeam: "AWAaz Team",
    joinUs: "Join Us",
    pageNotFound: "Page Not Found",
    returnHome: "Return Home",
    uploadAudio: "Upload Audio",
    chooseAudioFile: "Choose Audio File",
    uploading: "Uploading...",
    audioFileName: "Audio File Name",
    audioFileDescription: "Audio File Description",
    selectLanguage: "Select Language",
    submit: "Submit",
    uploadSuccessful: "Upload Successful!",
    uploadFailed: "Upload Failed",
    locationConsent: "Location Consent",
    locationConsentDescription: "We need your consent to access your location for language mapping purposes. This data helps us understand the geographic distribution of languages and dialects.",
    grantAccess: "Grant Access",
    locationAccessDenied: "Location Access Denied",
    locationAccessDeniedDescription: "You have denied location access. Please enable it in your browser settings to improve language map accuracy.",
    okay: "Okay",
    locationServicesDisabled: "Location Services Disabled",
    locationServicesDisabledDescription: "Please enable location services in your device settings to allow us to determine your location.",
    goToSettings: "Go to Settings",
    recordings: "Recordings",
    recordingsFound: "recordings found",
    noRecordingsFound: "No recordings found",
    resetPassword: "Reset Password",
    resetPasswordDescription: "Enter your email address and we'll send you a link to reset your password.",
    resetPasswordButton: "Send Reset Link",
    resettingPassword: "Sending...",
    newPasswordRequired: "New Password Required",
    newPasswordDescription: "Enter your new password below.",
    newPasswordButton: "Update Password",
    updatingPassword: "Updating...",
    passwordResetSuccess: "Password Reset Successful!",
    passwordResetSuccessDescription: "Your password has been successfully reset. You can now log in with your new password.",
    goBackToLogin: "Go Back to Login",
    targetLanguage: "Target Language",
    selectTranslationLanguage: "Select the language you want to translate to",
    translateTo: "Translate to",
    availableTasks: "Available",
    completed: "Completed",
    selectRecording: "Select a recording to translate",
    noRecordingsToTranslate: "No recordings available for translation in this language",
    noCompletedTranslations: "No completed translations yet",
    originalTranscription: "Original Transcription",
    translateToHindi: "Translate to Hindi",
    translateToEnglish: "Translate to English",
    enterTranslationHere: "Enter your translation here...",
    submitting: "Submitting...",
    submitTranslation: "Submit Translation",
    success: "Success",
    translationSaved: "Translation saved successfully",
    translationSubmissionFailed: "Failed to submit translation",
    signInToTranslate: "Sign in to translate",
    createAccountOrSignInToTranslate: "Create an account or sign in to help translate recordings",
    translationInstructions: "Help preserve languages by translating recordings into other languages.",
    speaker: "Speaker",
    allRecordings: "All Recordings",
    bookmarked: "Bookmarked",
    followed: "Followed",
    yourArchiveIsEmpty: "Your archive is empty",
    startRecording: "Start recording to build your collection",
    recordNow: "Record Now",
    noMatchingRecordings: "No matching recordings found",
    tryAdjustingFilters: "Try adjusting your search filters",
    clearFilters: "Clear Filters",
    storyThreads: "Story Threads",
    part: "part",
    parts: "parts",
    individualRecordings: "Individual Recordings",
    // Community stats translations
    languagesArchived: "Languages Archived",
    recordingsUploaded: "Recordings Uploaded", 
    contributors: "Contributors",
    regionsRepresented: "Regions Represented",
    // Button and action translations
    continueToApp: "Continue to App",
    verificationSuccessful: "Verification Successful",
    verificationFailed: "Verification Failed",
    emailVerified: "Email Verified",
    resendVerificationEmail: "Resend Verification Email",
    goToHome: "Go to Home",
    // Fixed text formatting keys
    whatWouldYouLikeToDo: "What would you like to do?",
    communityImpact: "Community Impact",
    uploadExistingDescription: "Upload an existing recording to contribute",
    communityStatsDescription: "Real-time statistics from our growing community",
    fromForgottenToForever: "From forgotten to forever - help preserve languages for future generations",
    recordNewVoice: "Record New Voice",
    captureLanguageDescription: "Capture and preserve spoken language for future generations",
    startRecording: "Start Recording",
    browseArchive: "Browse Archive",
    exploreRecordingsDescription: "Explore and listen to recordings from our community",
    exploreArchive: "Explore Archive",
    translateRecording: "Translate Recording",
    helpTranslateDescription: "Help make recordings accessible by translating them",
    startTranslating: "Start Translating",
    uploadRecording: "Upload Recording",
    uploadFiles: "Upload Files",
    learnAboutAWAaz: "Learn About AWAaz",
    // Community stats translations
    languagesArchived: "Languages Archived",
    totalRecordings: "Total Recordings",
    regionsCovered: "Regions Covered",
    // Button and action translations
    continueToApp: "Continue to App",
    verificationSuccessful: "Verification Successful",
    verificationFailed: "Verification Failed",
    emailVerified: "Email Verified",
    resendVerificationEmail: "Resend Verification Email",
    goToHome: "Go to Home",
    // Settings translations
    profile: "Profile",
    languagePreference: "Language Preference",
    selectLanguage: "Select Language",
    changePassword: "Change Password",
    notifications: "Notifications",
    receiveEmailNotifications: "Receive Email Notifications",
    noDevicesLinked: "No devices linked",
    dangerZone: "Danger Zone",
    confirmDeletion: "Confirm Deletion",
    deleteAccountWarning: "This action will permanently delete your account and all associated data. This cannot be undone.",
    cancel: "Cancel",
    delete: "Delete",
    guest: "Guest",
  },
  hi: {
    home: "होम",
    record: "रिकॉर्ड",
    archive: "अभिलेख",
    translate: "अनुवाद",
    settings: "सेटिंग्स",
    about: "के बारे में",
    login: "लॉग इन",
    register: "रजिस्टर",
    logout: "लॉग आउट",
    email: "ईमेल",
    password: "पासवर्ड",
    error: "त्रुटि",
    passwordsDoNotMatch: "पासवर्ड मेल नहीं खाते",
    welcomeBack: "वापस स्वागत है!",
    loginToContinue: "जारी रखने के लिए लॉग इन करें",
    loggingIn: "लॉग इन कर रहा है...",
    createAccount: "खाता बनाएं",
    joinAWAaz: "आवाज़ में शामिल हों",
    whatToCallYou: "हम आपको क्या बुलाएं?",
    yourName: "आपका नाम",
    confirmPassword: "पासवर्ड की पुष्टि करें",
    creating: "बना रहा है...",
    createAccountButton: "खाता बनाएं",
    upload: "अपलोड",
    languageMap: "भाषा मानचित्र",
    general: "सामान्य",
    account: "खाता",
    preferences: "प्राथमिकताएँ",
    displayName: "डिस्प्ले नाम",
    updateProfile: "प्रोफ़ाइल अपडेट करें",
    currentPassword: "वर्तमान पासवर्ड",
    newPassword: "नया पासवर्ड",
    updatePassword: "पासवर्ड अपडेट करें",
    deleteAccount: "खाता हटाएं",
    deleteAccountConfirmation: "क्या आप वाकई अपना खाता हटाना चाहते हैं? इस कार्रवाई को वापस नहीं किया जा सकता।",
    iUnderstand: "मैं परिणामों को समझता हूं",
    deleteMyAccount: "मेरा खाता हटाएं",
    language: "भाषा",
    english: "अंग्रेज़ी",
    hindi: "हिंदी",
    save: "सहेजें",
    saved: "सहेजा गया",
    automaticTranslation: "स्वचालित अनुवाद",
    automaticTranslationDescription: "रिकॉर्डिंग को अपनी पसंदीदा भाषा में स्वचालित रूप से अनुवाद करें।",
    locationTracking: "स्थान ट्रैकिंग",
    locationTrackingDescription: "भाषा मानचित्र सटीकता को बेहतर बनाने के लिए स्थान ट्रैकिंग सक्षम करें।",
    recordAudio: "ऑडियो रिकॉर्ड करें",
    stopRecording: "रिकॉर्डिंग रोकें",
    uploadRecording: "रिकॉर्डिंग अपलोड करें",
    translation: "अनुवाद",
    originalText: "मूल पाठ",
    translatedText: "अनुवादित पाठ",
    recordNew: "नया रिकॉर्ड करें",
    signInWithGoogle: "गूगल से साइन इन करें",
    signOut: "साइन आउट",
    audioArchive: "ऑडियो संग्रह",
    noRecordings: "अभी तक कोई रिकॉर्डिंग नहीं है। उन्हें देखने के लिए रिकॉर्डिंग शुरू करें।",
    searchRecordings: "रिकॉर्डिंग खोजें",
    search: "खोज",
    clearSearch: "खोज साफ़ करें",
    aboutAWAaz: "आवाज़ के बारे में",
    awaazDescription: "आवाज़ एक मंच है जो भाषाई विविधता को संरक्षित और बढ़ावा देने के लिए समर्पित है। दुनिया भर की भाषाओं का दस्तावेजीकरण करने में मदद करने के लिए ऑडियो रिकॉर्डिंग रिकॉर्ड करें, अनुवाद करें और साझा करें।",
    ourMission: "हमारा मिशन",
    ourMissionDescription: "सुलभ प्रौद्योगिकी के माध्यम से समुदायों को अपनी भाषाओं और संस्कृतियों को संरक्षित करने के लिए सशक्त बनाना।",
    contactUs: "संपर्क करें",
    contactUsDescription: "कोई प्रश्न या प्रतिक्रिया है? हमसे संपर्क करें!",
    termsOfService: "सेवा की शर्तें",
    privacyPolicy: "गोपनीयता नीति",
    awaazTeam: "आवाज़ टीम",
    joinUs: "हमसे जुड़ें",
    pageNotFound: "पृष्ठ नहीं मिला",
    returnHome: "घर लौटें",
    uploadAudio: "ऑडियो अपलोड करें",
    chooseAudioFile: "ऑडियो फ़ाइल चुनें",
    uploading: "अपलोड हो रहा है...",
    audioFileName: "ऑडियो फ़ाइल का नाम",
    audioFileDescription: "ऑडियो फ़ाइल विवरण",
    selectLanguage: "भाषा का चयन करें",
    submit: "जमा करें",
    uploadSuccessful: "अपलोड सफल!",
    uploadFailed: "अपलोड विफल",
    locationConsent: "स्थान सहमति",
    locationConsentDescription: "हमें भाषा मानचित्रण उद्देश्यों के लिए आपके स्थान तक पहुंचने के लिए आपकी सहमति की आवश्यकता है। यह डेटा हमें भाषाओं और बोलियों के भौगोलिक वितरण को समझने में मदद करता है।",
    grantAccess: "पहुंच प्रदान करें",
    locationAccessDenied: "स्थान पहुंच अस्वीकृत",
    locationAccessDeniedDescription: "आपने स्थान पहुंच से इनकार कर दिया है। भाषा मानचित्र सटीकता को बेहतर बनाने के लिए कृपया इसे अपनी ब्राउज़र सेटिंग में सक्षम करें।",
    okay: "ठीक है",
    locationServicesDisabled: "स्थान सेवाएं अक्षम हैं",
    locationServicesDisabledDescription: "कृपया हमें अपना स्थान निर्धारित करने की अनुमति देने के लिए अपनी डिवाइस सेटिंग में स्थान सेवाएं सक्षम करें।",
    goToSettings: "सेटिंग्स पर जाएं",
    recordings: "रिकॉर्डिंग",
    recordingsFound: "recordings found",
    noRecordingsFound: "No recordings found",
    resetPassword: "पासवर्ड रीसेट करें",
    resetPasswordDescription: "अपना ईमेल पता दर्ज करें और हम आपको अपना पासवर्ड रीसेट करने के लिए एक लिंक भेजेंगे।",
    resetPasswordButton: "रीसेट लिंक भेजें",
    resettingPassword: "भेज रहा है...",
    newPasswordRequired: "नए पासवर्ड की आवश्यकता है",
    newPasswordDescription: "नीचे अपना नया पासवर्ड दर्ज करें।",
    newPasswordButton: "पासवर्ड अपडेट करें",
    updatingPassword: "अपडेट कर रहा है...",
    passwordResetSuccess: "पासवर्ड रीसेट सफल!",
    passwordResetSuccessDescription: "आपका पासवर्ड सफलतापूर्वक रीसेट कर दिया गया है। अब आप अपने नए पासवर्ड से लॉग इन कर सकते हैं।",
    goBackToLogin: "लॉगिन पर वापस जाएं",
    targetLanguage: "लक्ष्य भाषा",
    selectTranslationLanguage: "उस भाषा का चयन करें जिसमें आप अनुवाद करना चाहते हैं",
    translateTo: "में अनुवाद करें",
    availableTasks: "उपलब्ध",
    completed: "पूर्ण",
    selectRecording: "अनुवाद करने के लिए एक रिकॉर्डिंग का चयन करें",
    noRecordingsToTranslate: "इस भाषा में अनुवाद के लिए कोई रिकॉर्डिंग उपलब्ध नहीं है",
    noCompletedTranslations: "अभी तक कोई पूर्ण अनुवाद नहीं है",
    originalTranscription: "मूल प्रतिलेखन",
    translateToHindi: "हिंदी में अनुवाद करें",
    translateToEnglish: "अंग्रेजी में अनुवाद करें",
    enterTranslationHere: "यहाँ अपना अनुवाद दर्ज करें...",
    submitting: "जमा कर रहा है...",
    submitTranslation: "अनुवाद जमा करें",
    success: "सफलता",
    translationSaved: "अनुवाद सफलतापूर्वक सहेजा गया",
    translationSubmissionFailed: "अनुवाद जमा करने में विफल",
    signInToTranslate: "अनुवाद करने के लिए साइन इन करें",
    createAccountOrSignInToTranslate: "रिकॉर्डिंग का अनुवाद करने में मदद के लिए खाता बनाएं या साइन इन करें",
    translationInstructions: "रिकॉर्डिंग का अन्य भाषाओं में अनुवाद करके भाषाओं को संरक्षित करने में मदद करें।",
    speaker: "वक्ता",
    allRecordings: "सभी रिकॉर्डिंग",
    bookmarked: "बुकमार्क किए गए",
    followed: "फॉलो किए गए",
    yourArchiveIsEmpty: "आपका संग्रह खाली है",
    startRecording: "अपना संग्रह बनाने के लिए रिकॉर्डिंग शुरू करें",
    recordNow: "अब रिकॉर्ड करें",
    noMatchingRecordings: "कोई मेल खाती रिकॉर्डिंग नहीं मिली",
    tryAdjustingFilters: "अपने खोज फ़िल्टर को समायोजित करने का प्रयास करें",
    clearFilters: "फ़िल्टर साफ़ करें",
    storyThreads: "कहानी श्रृंखला",
    part: "भाग",
    parts: "भाग",
    individualRecordings: "व्यक्तिगत रिकॉर्डिंग",
    // Fixed text formatting keys - Hindi translations
    whatWouldYouLikeToDo: "आप क्या करना चाहेंगे?",
    communityImpact: "सामुदायिक प्रभाव",
    uploadExistingDescription: "योगदान के लिए एक मौजूदा रिकॉर्डिंग अपलोड करें",
    communityStatsDescription: "हमारे बढ़ते समुदाय से वास्तविक समय के आंकड़े",
    fromForgottenToForever: "भूले से हमेशा के लिए - भविष्य की पीढ़ियों के लिए भाषाओं को संरक्षित करने में मदद करें",
    recordNewVoice: "नई आवाज़ रिकॉर्ड करें",
    captureLanguageDescription: "भविष्य की पीढ़ियों के लिए बोली जाने वाली भाषा को कैप्चर और संरक्षित करें",
    startRecording: "रिकॉर्डिंग शुरू करें",
    browseArchive: "संग्रह देखें",
    exploreRecordingsDescription: "हमारे समुदाय की रिकॉर्डिंग का अन्वेषण और सुनें",
    exploreArchive: "संग्रह का अन्वेषण करें",
    translateRecording: "रिकॉर्डिंग का अनुवाद करें",
    helpTranslateDescription: "रिकॉर्डिंग का अनुवाद करके उन्हें सुलभ बनाने में मदद करें",
    startTranslating: "अनुवाद शुरू करें",
    uploadRecording: "रिकॉर्डिंग अपलोड करें",
    uploadFiles: "फ़ाइलें अपलोड करें",
    learnAboutAWAaz: "आवाज़ के बारे में जानें",
    // Community stats translations
    languagesArchived: "संग्रहीत भाषाएं",
    totalRecordings: "कुल रिकॉर्डिंग",
    regionsCovered: "कवर किए गए क्षेत्र",
    // Button and action translations
    continueToApp: "ऐप पर जारी रखें",
    verificationSuccessful: "सत्यापन सफल",
    verificationFailed: "सत्यापन विफल",
    emailVerified: "ईमेल सत्यापित",
    resendVerificationEmail: "सत्यापन ईमेल पुनः भेजें",
    goToHome: "होम पर जाएं",
    // Settings translations
    profile: "प्रोफ़ाइल",
    languagePreference: "भाषा प्राथमिकता",
    selectLanguage: "भाषा चुनें",
    changePassword: "पासवर्ड बदलें",
    notifications: "सूचनाएं",
    receiveEmailNotifications: "ईमेल सूचनाएं प्राप्त करें",
    noDevicesLinked: "कोई डिवाइस लिंक नहीं है",
    dangerZone: "खतरनाक क्षेत्र",
    confirmDeletion: "हटाने की पुष्टि करें",
    deleteAccountWarning: "यह कार्रवाई आपके खाते और सभी संबंधित डेटा को स्थायी रूप से हटा देगी। इसे पूर्ववत नहीं किया जा सकता।",
    cancel: "रद्द करें",
    delete: "हटाएं",
    guest: "मेहमान",
  }
};

export const TranslationProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [currentLanguage, setCurrentLanguage] = useState<string>(() => {
    // Get stored language from localStorage or default to English
    if (typeof window !== 'undefined') {
      return localStorage.getItem('language') || 'en';
    }
    return 'en';
  });

  useEffect(() => {
    // Store language preference in localStorage
    if (typeof window !== 'undefined') {
      localStorage.setItem('language', currentLanguage);
    }
  }, [currentLanguage]);

  const changeLanguage = (lang: string) => {
    if (lang && (lang === 'en' || lang === 'hi')) {
      setCurrentLanguage(lang);
    }
  };

  const t = (key: string) => {
    // Get the translation based on the current language
    if (!translations[currentLanguage]) {
      return key; // Return the key if language doesn't exist
    }

    return translations[currentLanguage][key] || translations['en'][key] || key;
  };

  return (
    <TranslationContext.Provider value={{ t, changeLanguage, currentLanguage }}>
      {children}
    </TranslationContext.Provider>
  );
};

export const useTranslation = () => useContext(TranslationContext);
